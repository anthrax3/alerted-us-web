__author__ = 'kelvin'

from os import getenv
import base64
import requests
import random


if getenv('ALERTED_USERPASS'):
    ALERTED_API = str(getenv('ALERTED_API'))
    ALERTED_USERPASS = str(getenv('ALERTED_USERPASS'))
else:
    ALERTED_API = 'http://192.168.59.103:8000/api/v1/alerts/'
    ALERTED_USERPASS = 'admin:password'  # This is the same default password used in the dev alerted website

HEADERS = {'Content-Type': 'application/xml', 'Accept': 'application/xml',
            'Authorization': 'Basic %s' % base64.b64encode(ALERTED_USERPASS)}

FIPSLIST = ["26039","51015","51069","51097","50003","51077","47117","47127","47125","47121","47119","51067","26057","47131","47129","18091","26021","26159","51063","47059","26121","26013","26017","26157","51047","26059","51045","26065","51027","51023","26055","26041","5003","51019","51127","51135","26067","19049","27045","54077","54079","54075","54081","26073","51145","54069","51155","27047","31105","54059","54051","26075","55078","54047","54045","54029","54015","26077","54025","54083","26079","31119","54009","54005","18087","20181","51157","54101","54099","54109","34013","36085","34017","54091","36073","20179","20155","36093","13307","42097","13295","20153","13285","24025","13277","20151","20149","42095","10003","24005","24029","11001","51153","51179","51179","51099","24033","34017","34003","36119","36005","36061","36061","44001","13255","36117","36075","13249","36055","24015","23013","24003","23023","23015","5005","5007","5013","20147","51107","5015","5017","5021","5023","5027","5029","5033","5035","34039","10005","55141","25017","25027","26081","26085","51161","25021","23021","23025","23019","51167","51169","34005","36119","36115","26111","36035","36031","13247","36019","5039","5047","5049","19163","19149","19127","19125","19111","19057","19005","36033","36011","36065","36043","19041","19043","19045","19193","17077","17083","17085","17091","26113","36039","26117","17073","17113","17119","17127","17129","17133","17145","17149","51171","12027","12111","26119","51173","26123","36089","42027","51183","42127","42049","44007","44009","51061","13243","26129","51187","51197","31183","50011","24001","54057","13233","17157","17161","17163","17167","25009","25023","51003","44003","31001","23031","23005","23007","23029","34009","9011","34001","23009","36059","34029","24047","26133","34013","25001","23011","9007","9001","26135","17169","50005","50009","34033","24039","24035","36013","36103","17179","17181","36047","24017","24041","24019","36045","18011","18013","21215","51005","26137","37091","37041","20145","13231","20143","20141","20139","20137","13287","13281","13225","13275","13273","51177","51035","13223","51031","13171","21219","13257","51089","13241","17185","17189","17193","17195","17003","17009","17013","13235","13227","31167","39037","13217","39039","17017","17021","17023","17027","17047","17061","13057","31005","13169","13059","13011","17055","17057","17059","27073","27015","13201","13197","28159","28103","13035","51121","28101","13173","13167","13165","39057","13081","13293","13083","27019","27023","27025","27037","27049","13109","13085","28099","31003","13005","19051","19053","13013","13015","13037","19197","13021","13023","19191","13047","13055","19105","39065","13089","13069","19187","13097","18015","18017","18023","39101","39103","13093","13095","19189","13117","13129","13119","13131","13125","13143","13149","18033","18035","13141","27053","27069","27097","27127","27129","27139","13147","18041","27141","27143","27145","27163","27171","27173","17089","13063","26015","27011","27013","29013","29015","29019","29021","26001","26165","26069","26043","26045","26049","26051","26071","26087","39109","26091","37001","26093","26101","26107","26125","37139","37073","37015","39133","37005","39135","18177","37021","37025","39137","46077","37039","1075","37063","37057","18179","21073","39159","37069","39161","21083","21085","46073","37109","37135","37081","37083","37087","37145","37089","20135","37169","37115","37119","29023","29027","29029","29031","29037","29039","20133","17191","37151","37181","37157","37185","37165","37195","20131","37173","17199","20129","28097","28081","39005","37193","28079","20127","39001","39003","39011","39021","39023","39017","39019","39029","39041","39031","39033","39045","39047","39049","39051","39053","39169","39061","39063","39069","39075","39077","39079","39083","39171","39091","38075","39097","39099","38079","39107","39113","39115","39117","18085","72145","39125","18083","39127","39139","39131","39141","39155","54033","54017","39147","39149","39153","18081","39163","39165","51065","45027","45035","51036","46067","51550","13103","45075","45089","37095","37137","51103","18075","46049","18069","45025","13239","18067","31145","18065","45057","45059","45063","18063","45065","45069","45071","45079","20125","13317","20123","13315","45003","18059","51041","20121","51830","18057","20119","51049","51033","18055","51093","51007","37091","51159","51710","37019","37019","37031","37133","37141","37095","37187","13313","13311","37029","20117","18053","18143","13309","37163","37047","45067","1111","45041","45085","51193","51133","51115","51199","51650","51810","37055","45019","45019","20115","13049","37103","39085","39143","51131","18049","37061","51093","13121","1013","13305","18141","37161","37053","20113","39007","45045","45073","45077","13039","13051","13051","39035","39043","13127","51001","37049","18139","1037","45053","45013","37053","37041","45043","18135","1009","1007","20111","18047","1045","1031","1047","13303","1035","1057","1043","20099","13301","1059","1061","1063","13299","13291","18119","13289","18117","18133","18131","20035","13283","1093","1133","13279","1099","18115","1105","18113","20037","18111","1113","1115","1119","1121","18171","1129","20039","18109","18161","18107","18121","18153","18151","18105","18127","18001","18007","18077","18009","18045","18043","18003","18005","18183","18027","28077","18029","18031","18039","18181","18021","18137","21117","21141","27059","21109","27063","21133","21135","21137","21143","46045","21149","21151","46035","21157","21163","21169","38081","21171","21173","21175","21179","21191","21193","21195","21201","21187","38083","27065","27067","21205","27083","21207","21211","21213","27085","21223","27087","27091","28075","27093","27099","28155","28145","28143","27101","27103","21019","21001","27105","27109","21021","28073","21035","27117","21025","21037","21027","27121","46011","27123","21039","21041","21045","21057","21047","21061","27125","21107","27131","27133","27135","21067","27147","21077","21079","21081","21087","21105","27149","21093","21095","27151","38087","21053","21125","26143","26145","26149","38095","26155","26161","28161","31009","28007","28009","28001","31011","28153","28149","28147","28139","20041","20051","28133","28131","28129","28125","28123","28057","28055","28091","28089","28085","13271","13267","28069","28067","28065","28063","28043","20053","28049","28041","28039","28037","28031","27153","31013","13265","28023","28017","31045","51085","28013","28011","28003","28163","20055","5043","20057","47161","20059","51083","20097","20095","47169","51079","20093","20091","51071","51051","19183","17123","17125","17101","19181","51037","19179","19177","47183","19175","19173","51029","19171","51021","19169","19159","19157","51017","47015","19153","51011","47017","19151","20089","47047","51009","47027","47031","47083","47033","20081","20079","19145","19143","19141","20077","51113","47051","20075","47057","20065","38105","19103","19101","19093","47069","51105","51139","47073","19091","50017","19089","50019","50023","19087","47079","19081","50013","19079","54073","19077","47109","54067","54065","47093","47095","47097","47111","54063","28045","26089","54061","26151","26099","26147","26053","19075","54055","54053","19073","54049","1017","1025","28059","47167","19065","19063","47139","1003","26163","54043","28047","26083","26105","26127","13263","13261","18089","28113","13259","5019","19003","26005","26007","1067","47123","19011","47019","47009","26127","26121","5037","26139","26139","26031","26033","19013","26095","26097","26153","26141","26109","26003","26131","26019","19015","19017","54039","54037","54035","5001","5011","54031","19019","19021","5025","19023","19025","19027","5031","19029","19031","19033","54027","54021","5041","5045","19035","19139","5051","19137","19135","5053","19185","29041","29045","29047","29051","29053","29083","29087","29089","29091","29093","19167","19165","29095","29099","29105","29107","29113","29131","19161","19155","19129","19147","19133","19131","19119","19117","19037","19115","19113","19109","19097","19095","19085","19083","19071","19069","19067","19061","19059","19039","19055","19001","19007","19009","38001","54019","54013","19195","17081","17177","17087","54011","17093","17075","17109","17099","17111","54007","17117","17105","17107","17115","17121","17131","17051","54003","17135","54103","17137","17139","17141","17159","54105","17143","17171","17147","38003","38005","54107","54001","17151","17173","17153","17155","54097","17175","54095","17165","38007","38019","17187","17183","38031","38033","38039","17201","54093","17197","17203","17063","17001","17005","17007","17015","54089","17011","17019","46005","46003","46095","17029","54087","17037","17025","17039","17041","17033","17035","17043","17045","54085","17049","20073","17053","27055","17071","27057","17069","17067","17065","42045","17103","17095","27077","20071","27003","27009","27137","20069","27035","27041","34015","27033","23001","27039","27051","24013","27079","27081","27095","27157","27107","29133","29135","29137","29141","29143","29147","29151","29155","27113","27159","27115","13251","27161","20209","13245","20001","27155","20003","27165","27169","29011","13237","29025","20011","13229","29017","29035","20013","13221","13219","29033","38047","29043","29061","42029","29049","29063","29055","29065","29081","29067","29069","20015","29071","20017","24011","29073","29075","29077","29079","29085","13215","29009","55081","29111","29119","29129","29101","29103","55133","20019","20021","29115","29117","34023","29121","29123","29125","29127","29057","20023","29149","29139","31063","29145","29173","29175","55101","29153","55005","55015","42051","29159","29205","29209","29163","29211","29213","29167","29169","31065","29177","55017","29181","29157","55019","55025","29161","55027","31067","29165","29199","55033","29171","55035","29215","55039","31075","55041","55043","29225","29227","31077","29510","31079","29059","29001","31087","55045","29179","55047","29007","55129","55053","31091","13213","13211","13209","55055","55073","31093","55077","13207","55065","31095","55069","55137","55087","31097","55135","55127","20025","13205","55119","13199","55113","13195","13189","55107","13187","55105","55097","55103","55099","20027","13185","55139","13181","55131","17097","17031","55071","20029","55061","27027","27071","27021","20031","27001","27061","5097","20177","27005","27029","27119","55031","55007","55003","55089","27167","55117","20175","12049","20173","13175","13319","12105","12043","12085","12103","12115","12021","12086","20171","5059","20169","13161","5061","13193","20167","13177","5069","5071","20165","13269","13027","5077","5081","5113","13001","13003","5085","13007","5091","5093","20163","13009","13017","5103","5111","5107","20159","5109","20157","20033","5009","13019","20195","13025","5129","20193","13031","5133","20191","5139","20189","13033","5141","20187","13045","5145","20185","13053","20109","20107","20105","20101","20087","20085","20083","20007","20009","13321","13065","13067","20047","20049","13071","13073","20063","13075","38011","38013","13077","38017","13079","38023","38027","13091","38037","38043","38045","38051","38055","38069","13099","38063","13101","38073","13105","38089","38091","38093","13107","38103","38059","31007","13111","13113","31037","31023","13115","31033","31035","31039","13123","13133","31029","13135","13137","31043","31047","31049","31099","31055","31053","31057","31059","13139","31071","31073","31083","31085","13145","31089","13151","31107","31109","31113","31115","31117","13153","13155","31123","31125","46115","31127","31129","46099","13157","31133","31135","31137","31139","46097","13163","31143","31153","37093","31151","31159","31157","31161","31163","31185","31175","46091","31179","31181","46121","46089","46113","46111","46087","46085","46109","46107","46105","46101","46079","51103","46069","37143","46063","46061","46059","46057","46053","46051","37003","46043","46041","46039","46037","37007","37009","46029","46025","46023","46047","37011","37035","46017","22099","22057","22051","37037","46013","46007","46075","46125","22093","22085","22083","46135","37043","37045","22107","37051","22081","22079","37059","37065","22069","22067","37067","22049","22043","37071","37075","37077","22035","22029","22025","22003","22001","22065","22017","22095","37079","12003","37097","37105","37113","37121","22101","22101","22063","12019","37123","37125","37197","12023","12109","37131","12121","21121","12083","38053","21123","38085","46117","29183","12063","12063","21127","22071","38077","22109","38099","31165","29185","46081","46103","37147","29186","29187","37153","37155","37167","37171","37175","37179","37183","37189","37199","37127","37159","39009","39013","39015","39059","39067","39073","39081","39087","39089","39093","39105","39111","39119","39121","39129","39145","39151","39157","39167","39173","39025","39071","45001","29189","45005","45007","45009","45021","45023","45031","45037","45039","45047","29195","29197","45055","45061","45081","45083","45091","45087","51149","51175","51081","29201","51087","29203","51075","51053","51025","51036","51109","51111","51117","37101","37107","37191","37085","45033","21131","21139","21145","45017","21147","29207","29217","29219","29221","29223","29229","21153","51800","21155","21159","21161","29003","21165","21167","21177","42129","29005","51091","54071","29109","25011","25015","21181","23003","21183","21185","23017","33003","33011","34031","36113","36001","36111","36027","36021","36083","55079","36091","42081","42035","50007","50001","50021","50025","55001","54023","25013","33015","34039","1073","24025","1077","51057","45049","1079","1081","51159","1083","55011","51057","55013","51800","1085","55021","55023","72035","72041","1087","1089","72057","72067","1091","72111","1095","72005","21189","9003","24023","21197","21199","24021","24031","1101","1103","1107","1109","55037","55049","21203","21209","21217","21221","21225","21227","55057","21229","1117","1123","1125","1127","1131","45015","55063","45051","55067","55085","1001","55091","55125","13029","45011","18165","18163","24045","33019","33001","33017","18155","72079","72085","72095","34007","72123","72133","72151","72083","72049","72053","34019","72147","34021","34035","34037","78030","72115","36007","36017","36025","36037","15001","36041","36067","36095","36099","36101","15009","72119","72087","36107","66010","69085","69110","69120","24015","24029","24037","51181","13297","24037","36085","36005","13029","25007","36063","21231","24005","25025","10001","24027","33013","21233","24003","72137","9009","9005","25003","24035","34025","34003","18147","23027","33007","18175","34011","25005","55123","15003","36029","36081","36081","24009","18129","24041","18125","55121","24019","33009","54041","37055","37017","37029","18123","13087","18079","55115","13087","55111","51115","37139","51193","37143","37015","55109","51133","51073","51095","51710","51119","55095","13253","51119","55093","13253","39095","37111","39123","39055","37149","51073","13061","37099","51181","13179","55059","45029","13183","37117","18071","13191","18061","55009","13191","37013","45043","37177","37129","1015","1011","55083","12051","37129","1005","37141","21011","21013","21015","21017","21023","21029","21031","21069","21071","21089","21091","21097","21103","12055","28121","28095","28093","28087","28083","28071","28053","12097","28109","47133","47135","47137","47141","47143","47149","47151","47153","47157","47159","47163","47189","47185","47043","47105","47001","26115","47029","47155","26103","26029","26061","26009","26011","26063","26047","12093","1097","26105","55029","27075","27031","27111","27089","55051","55075","12061","12087","12011","12115","12099","5055","5057","5063","5147","5149","20161","20103","20005","20043","20045","20061","46127","46129","46137","22111","22097","22073","22061","22059","22055","22041","22039","22031","22015","22013","22011","22005","22119","22009","22125","12013","12007","12001","12107","12035","22103","12059","31031","12045","46093","46033","22113","22045","36109","36121","42003","42009","42013","42017","37027","5065","37023","1071","1019","1021","72097","72103","1023","1027","1029","1033","1039","1041","1049","5067","5073","5075","5079","5083","42031","5089","42033","42039","42043","42057","42065","42067","42069","42077","42079","42087","42091","42107","42109","42117","42119","42101","1051","1053","1055","1065","1069","5095","5087","5099","5101","18051","18019","18025","18037","18173","21111","21113","21115","5105","5115","5117","5119","5121","5123","5125","5127","5131","5135","21119","5137","5143","38009","38015","38021","38029","38035","38041","38049","38057","38061","38065","38067","38071","21235","21237","21239","21129","21075","21003","21005","21007","21009","21033","21043","21049","38097","38101","31015","31017","31019","31021","31025","31027","31041","31051","31061","31069","31081","31103","31111","31121","31131","21051","31141","31147","31149","31155","31169","21055","31173","31177","21059","21063","46123","46119","46083","21065","21101","21099","28005","28157","46071","46065","28151","28141","28137","28135","28127","28051","28033","28029","28027","28025","28021","28019","28015","47145","47147","47165","47171","47173","47175","47177","47179","47181","47187","46055","46031","46027","46021","46015","46009","46019","22027","47003","47005","47007","47011","22021","22121","47013","47021","47023","47025","47035","47037","47039","22123","22127","47041","47045","47049","47053","47055","47061","47063","47065","47067","47071","47075","47077","47081","47085","47087","22115","47089","60040","60020","60050","60010","47091","47099","47101","72011","72021","47103","47107","47113","47115","22089","72015","72017","72019","22007","22091","22077","72025","72029","72047","72037","72039","72054","72055","72043","72045","72059","72061","72063","72065","22037","22033","72073","72075","72077","72081","12041","12047","72091","72093","72101","26023","72099","72105","72107","72109","72113","72121","72125","72127","72129","72139","12067","12073","12125","72141","72131","72143","72149","72031","72153","72001","72007","72009","78010","72013","72117","9013","72071","72027","72051","72135","72003","72023","72033","72089","72069","78020","15007","69100","28119","9015","25019","13043","28117","12079","22019","22053","38025","22047","24043","24017","50027","19123","36123","33005","28115","34041","39175","20183","34027","36015","28111","18169","36003","36023","18167","36009","36079","19121","36049","18159","36051","36053","36057","36087","36069","18157","36071","36077","18149","36097","42001","42007","36105","18145","42105","42053","42075","42005","19107","28107","42011","31101","42015","42083","42019","42085","42021","42023","42037","42113","42041","42115","42047","42123","42125","42055","42131","42133","42059","42061","42063","51013","42071","42073","42093","42099","42103","27043","31171","42089","28105","18103","42111","51043","42121","50015","42025","44005","18101","51099","37033","51137","51125","51141","51143","18099","51147","19047","18097","51163","51165","39027","51101","18095","51185","18093","26025","51191","51195","26027","51059","26035","26037","51153"]

def generate_text():
    txt = """
            <?xml version = '1.0' encoding = 'UTF-8' standalone = 'yes'?>
            <?xml-stylesheet href='http://alerts.weather.gov/cap/capatomproduct.xsl' type='text/xsl'?>

            <!--
            This atom/xml feed is an index to active advisories, watches and warnings
            issued by the National Weather Service.  This index file is not the complete
            Common Alerting Protocol (CAP) alert message.  To obtain the complete CAP
            alert, please follow the links for each entry in this index.  Also note the
            CAP message uses a style sheet to convey the information in a human readable
            format.  Please view the source of the CAP message to see the complete data
            set.  Not all information in the CAP message is contained in this index of
            active alerts.
            -->

            <alert xmlns = 'urn:oasis:names:tc:emergency:cap:1.1'>

            <!-- http-date = Sun, 11 May 2014 04:00:00 GMT -->
            <identifier>%s</identifier>
            <sender>w-nws.webmaster@noaa.gov</sender>
            <sent>2014-05-10T22:00:00-06:00</sent>
            <status>Actual</status>
            <msgType>Alert</msgType>
            <scope>Public</scope>
            <note>Test note</note>
            <info>
            <category>Met</category>
            <event>Wind Advisory</event>
            <urgency>Expected</urgency>
            <severity>Minor</severity>
            <certainty>Likely</certainty>
            <eventCode>
            <valueName>SAME</valueName>
            <value></value>
            </eventCode>
            <effective>2014-05-10T22:00:00-06:00</effective>
            <expires>2016-05-11T19:00:00-06:00</expires>
            <senderName>NWS Albuquerque (Northern and Central New Mexico)</senderName>
            <headline>Wind Advisory issued May 10 at 10:00PM MDT until May 11 at 7:00PM MDT by NWS Albuquerque</headline>
            <description>Test Description</description>
            <instruction>MOTORISTS SHOULD EXERCISE CAUTION WHILE TRAVELLING. SUDDEN GUSTS
            OF WIND MAY CAUSE YOU TO LOSE CONTROL OF YOUR VEHICLE. EXTRA
            ATTENTION SHOULD BE GIVEN TO CROSS WINDS.</instruction>
            <parameter>
            <valueName>WMOHEADER</valueName>
            <value></value>
            </parameter>
            <parameter>
            <valueName>UGC</valueName>
            <value>NMZ501>507-509>520-522-528-531>540</value>
            </parameter>
            <parameter>
            <valueName>VTEC</valueName>
            <value>/O.CON.KABQ.WI.Y.0032.140511T1600Z-140512T0100Z/</value>
            </parameter>
            <parameter>
            <valueName>TIME...MOT...LOC</valueName>
            <value></value>
            </parameter>
            <area>
            <areaDesc>This is a sample description from weather.cap - FIPS codes were input to match sample FIPS codes in sample_data.json</areaDesc>
            <polygon></polygon>
            <geocode>
            <valueName>FIPS6</valueName>
            <value>%s</value>
            </geocode>
            </area>
            </info>
            </alert>
            """ % (random.randint(1,10000000000), random.choice(FIPSLIST))
    return txt


def generate_alerts():
    for x in xrange(10000):
        alert = generate_text()
        transmit(alert)


def transmit(alert):
    """
    A function to transmit XML to Alerted web service

    :param alert: XML CAP1.2 alert to transmit
    :return:
    """
    alert = alert.replace('\n', '')
    # Determine if the alert can be parsed as valid CAP XML
    result = False

    resp = requests.post(url=ALERTED_API, data=alert, headers=HEADERS, verify=False)

    if resp.status_code == 201:
        print "Success"
        result = True
    else:
        print "ERROR"

    return result

if __name__ == "__main__":
    generate_alerts()
